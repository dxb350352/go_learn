package main
import (
	js "github.com/bitly/go-simplejson"
	"fmt"
	"regexp"
	"strings"
	"github.com/sas/utils"
)
func main() {
	str := `{"a":"aa","b":"bb","c":"cc","d":0}   `
	strjson, _ := js.NewJson([]byte(str))
	fmt.Println(strjson.Get("d").MustString())
	fmt.Println(strjson)
	j, b := strjson.CheckGet("a")
	fmt.Println(j, b)
	m, _ := strjson.Map()
	fmt.Println(m)
	for k, v := range m {
		fmt.Println(k, v)
	}
	fmt.Println("..................................")
	body := `[{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_batch_log_0"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_batch_log_1"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_batch_log_2"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_batch_log_3"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_batch_log_4"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_batch_log_5"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_batch_log_6"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_batch_log_7"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_batch_log_8"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_batch_log_9"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_batch_result_log_0"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_batch_result_log_1"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_batch_result_log_10"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_batch_result_log_2"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_batch_result_log_3"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_batch_result_log_4"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_batch_result_log_5"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_batch_result_log_6"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_batch_result_log_7"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_batch_result_log_8"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_batch_result_log_9"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_task_configuration_log_0"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_task_configuration_log_1"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_task_configuration_log_10"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_task_configuration_log_11"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_task_configuration_log_2"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_task_configuration_log_3"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_task_configuration_log_4"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_task_configuration_log_5"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_task_configuration_log_6"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_task_configuration_log_7"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_task_configuration_log_8"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_assembly_task_configuration_log_9"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_0"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_1"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_10"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_11"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_12"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_13"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_14"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_15"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_16"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_17"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_18"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_19"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_2"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_20"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_21"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_22"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_23"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_24"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_25"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_26"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_27"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_28"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_29"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_3"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_30"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_31"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_4"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_5"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_6"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_7"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_8"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_card_fail_log_9"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_device_encryptor_log_0"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_device_encryptor_log_1"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_device_encryptor_log_10"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_device_encryptor_log_11"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_device_encryptor_log_2"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_device_encryptor_log_3"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_device_encryptor_log_4"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_device_encryptor_log_5"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_device_encryptor_log_6"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_device_encryptor_log_7"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_device_encryptor_log_8"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_device_encryptor_log_9"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_key_log_0"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_key_log_1"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_key_log_10"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_key_log_2"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_key_log_3"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_key_log_4"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_key_log_5"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_key_log_6"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_key_log_7"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_key_log_8"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_key_log_9"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_user_log_0"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_user_log_1"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_user_log_2"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_user_log_3"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_user_log_4"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_user_log_5"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_user_log_6"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_user_log_7"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_user_log_8"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_t_user_log_9"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_outgo_log_0"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_outgo_log_1"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_outgo_log_10"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_outgo_log_11"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_outgo_log_12"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_outgo_log_13"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_outgo_log_14"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_outgo_log_15"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_outgo_log_16"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_outgo_log_2"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_outgo_log_3"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_outgo_log_4"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_outgo_log_5"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_outgo_log_6"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_outgo_log_7"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_outgo_log_8"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_outgo_log_9"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_storage_log_0"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_storage_log_1"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_storage_log_10"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_storage_log_11"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_storage_log_12"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_storage_log_13"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_storage_log_14"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_storage_log_15"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_storage_log_16"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_storage_log_17"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_storage_log_2"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_storage_log_3"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_storage_log_4"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_storage_log_5"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_storage_log_6"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_storage_log_7"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_storage_log_8"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_empty_storage_log_9"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_finished_outgo_log_0"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_finished_outgo_log_1"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_finished_outgo_log_2"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_finished_outgo_log_3"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_finished_outgo_log_4"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_finished_outgo_log_5"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_finished_outgo_log_6"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_finished_outgo_log_7"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_finished_outgo_log_8"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_finished_storage_log_0"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_finished_storage_log_1"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_finished_storage_log_2"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_finished_storage_log_3"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_finished_storage_log_4"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_finished_storage_log_5"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_finished_storage_log_6"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_finished_storage_log_7"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_finished_storage_log_8"},{"doc_count": 1,"key": "192.168.130.240_3306_seal_v_card_finished_storage_log_9"}]`
	path := "[6].key"
	json, _ := js.NewJson([]byte(body))
	paths := strings.Split(path, ".")
	fmt.Println(getJsonValue(json, paths))
}


func getJsonValue(json *js.Json, paths []string) *js.Json {
	var result *js.Json
	if len(paths) >= 1 {
		if match, err := regexp.Match("\\[\\d*\\]", []byte(paths[0])); match&&err == nil {
			//数组
			if strings.HasPrefix(paths[0], "[") {
				result = json.GetIndex(utils.ParseInt(paths[0][1:len(paths[0]) - 1]))
			}else {
				result = json.Get(paths[0][0:strings.Index(paths[0], "[")]).GetIndex(utils.ParseInt(paths[0][strings.Index(paths[0], "[") + 1:len(paths[0]) - 1]))
			}
		}else {
			//字段
			result = json.Get(paths[0])
		}
	}else {
		return json
	}
	return getJsonValue(result, paths[1:])
}
